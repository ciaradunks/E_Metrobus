{% extends "base.html" %}

{% load static %}
{% load i18n %}

{% block header %}
  <script src="{% static 'js/plotly.min.js' %}"></script>
{% endblock %}

{% block content %}

<div class="cell">
  Meine Strecke:
  {{stations.0}} - {{stations.1}}
  <a href="{% url 'navigation:route' %}">{% trans 'Ã„ndern' %}</a>
</div>

<div class="cell" id="route_distance">
  {% blocktrans with distance=route_distance %}Impakt meiner Strecke ({{distance}} km) im Vergleich zu anderen Verkehrsmitteln{% endblocktrans %}
</div>
<div class="cell" id="fleet_distance" hidden>
  {% blocktrans with distance=fleet_distance %}Impakt der E-Bus Flotte ({{distance}} km) im Vergleich zu anderen Verkehrsmitteln{% endblocktrans %}
</div>

<button onclick="select_route('route');">{% trans 'Meine Strecke' %}</button>
<button onclick="select_route('fleet');">{% trans 'E-Bus Flotte' %}</button>
<button onclick="compare('co2');">{% trans 'CO<sub>2</sub>' %}</button>
<button onclick="compare('nitrogen');">{% trans 'NOx' %}</button>
<button onclick="compare('fine_dust');">{% trans 'Feinstaub' %}</button>

{% for chart_id, chart in charts.items %}
  <div class="cell chart" id="{{chart_id}}" hidden>
    {{chart.div|safe}}
  </div>
{% endfor %}

{% endblock content %}

{% block javascript %}
  {{block.super}}
  <script>
    let route = "route";
    let comparison = "co2";

    function select_route(value) {
      route = value;
      if (route == "route") {
        $("#route_distance").show();
        $("#fleet_distance").hide();
      } else {
        $("#route_distance").hide();
        $("#fleet_distance").show();
      }
      show_selection();
    };

    function compare(value) {
      comparison = value;
      show_selection();
    }

    function show_selection() {
      selected_chart = "#" + route + "_" + comparison;
      $(".chart").hide();
      $(selected_chart).show();
    }

    {% for chart in charts.values %}
      {{chart.script|safe}}
    {% endfor %}

    show_selection();
  </script>
{% endblock javascript %}
